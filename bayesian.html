<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Supplementary Information for: Hyoliths with pedicles constrain the origin of the brachiopod body plan</title>
  <meta name="description" content="Results of phylogenetic analysis">
  <meta name="generator" content="bookdown 0.7.13 and GitBook 2.6.7">

  <meta property="og:title" content="Supplementary Information for: Hyoliths with pedicles constrain the origin of the brachiopod body plan" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Results of phylogenetic analysis" />
  <meta name="github-repo" content="ms609/hyoliths" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Supplementary Information for: Hyoliths with pedicles constrain the origin of the brachiopod body plan" />
  
  <meta name="twitter:description" content="Results of phylogenetic analysis" />
  

<meta name="author" content="Haijing Sun, Martin R. Smith, Han Zeng, Fangchen Zhao, Guoxiang Li and Maoyan Zhu">


<meta name="date" content="2018-06-18">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="fitch.html">
<link rel="next" href="treesearch.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />







<link rel="apple-touch-icon" sizes="180x180" href="icons/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="icons/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="icons/favicon-16x16.png">
<link rel="manifest" href="icons/site.webmanifest">
<link rel="mask-icon" href="icons/safari-pinned-tab.svg" color="#5bbad5">
<link rel="shortcut icon" href="icons/favicon.ico">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="msapplication-config" content="icons/browserconfig.xml">
<meta name="theme-color" content="#ffffff">


<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Supplementary Text</a></li>
<li class="chapter" data-level="1" data-path="dataset.html"><a href="dataset.html"><i class="fa fa-check"></i><b>1</b> Phylogenetic dataset</a></li>
<li class="chapter" data-level="2" data-path="fitch.html"><a href="fitch.html"><i class="fa fa-check"></i><b>2</b> Fitch parsimony</a><ul>
<li class="chapter" data-level="2.1" data-path="fitch.html"><a href="fitch.html#results"><i class="fa fa-check"></i><b>2.1</b> Results</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="bayesian.html"><a href="bayesian.html"><i class="fa fa-check"></i><b>3</b> Bayesian analysis</a><ul>
<li class="chapter" data-level="3.1" data-path="bayesian.html"><a href="bayesian.html#parameter-estimates"><i class="fa fa-check"></i><b>3.1</b> Parameter estimates</a></li>
<li class="chapter" data-level="3.2" data-path="bayesian.html"><a href="bayesian.html#results-1"><i class="fa fa-check"></i><b>3.2</b> Results</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="treesearch.html"><a href="treesearch.html"><i class="fa fa-check"></i><b>4</b> Corrected parsimony</a><ul>
<li class="chapter" data-level="4.1" data-path="treesearch.html"><a href="treesearch.html#search-parameters"><i class="fa fa-check"></i><b>4.1</b> Search parameters</a></li>
<li class="chapter" data-level="4.2" data-path="treesearch.html"><a href="treesearch.html#analysis"><i class="fa fa-check"></i><b>4.2</b> Analysis</a><ul>
<li class="chapter" data-level="4.2.1" data-path="treesearch.html"><a href="treesearch.html#initialize-and-load-data"><i class="fa fa-check"></i><b>4.2.1</b> Initialize and load data</a></li>
<li class="chapter" data-level="4.2.2" data-path="treesearch.html"><a href="treesearch.html#generate-starting-tree"><i class="fa fa-check"></i><b>4.2.2</b> Generate starting tree</a></li>
<li class="chapter" data-level="4.2.3" data-path="treesearch.html"><a href="treesearch.html#implied-weights-analysis"><i class="fa fa-check"></i><b>4.2.3</b> Implied weights analysis</a></li>
<li class="chapter" data-level="4.2.4" data-path="treesearch.html"><a href="treesearch.html#equal-weights-analysis"><i class="fa fa-check"></i><b>4.2.4</b> Equal weights analysis</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="treesearch.html"><a href="treesearch.html#results-2"><i class="fa fa-check"></i><b>4.3</b> Results</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="reconstructions.html"><a href="reconstructions.html"><i class="fa fa-check"></i><b>5</b> Character reconstructions</a></li>
<li class="chapter" data-level="6" data-path="taxonomic-implications.html"><a href="taxonomic-implications.html"><i class="fa fa-check"></i><b>6</b> Taxonomic implications</a></li>
<li class="chapter" data-level="" data-path="figures.html"><a href="figures.html"><i class="fa fa-check"></i>Supplementary Figures</a></li>
<li class="chapter" data-level="" data-path="table.html"><a href="table.html"><i class="fa fa-check"></i>Supplementary Table</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Supplementary Information for: Hyoliths with pedicles constrain the origin of the brachiopod body plan</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="bayesian" class="section level1">
<h1><span class="header-section-number">3</span> Bayesian analysis</h1>
<p>Bayesian search was conducted in MrBayes v3.2.6 <span class="citation">(Ronquist et al., <a href="#ref-Ronquist2012">2012</a>)</span> using the Mk model <span class="citation">(Lewis, <a href="#ref-Lewis2001">2001</a>)</span> with gamma-distributed rate variation across characters:</p>
<blockquote>
<p>lset coding=variable rates=gamma;</p>
</blockquote>
<p>Branch length was drawn from a dirichlet prior distribution, which is less informative than an exponential model <span class="citation">(Rannala, Zhu, &amp; Yang, <a href="#ref-Rannala2012">2012</a>)</span>, but requires a prior mean tree length within about two orders of magnitude of the true value <span class="citation">(C. Zhang, Rannala, &amp; Yang, <a href="#ref-Zhang2012">2012</a>)</span>. To satisfy this latter criterion, we specified the prior mean tree length to be equal to the length of the most parsimonious tree under equal weights, using a Dirichlet prior with <span class="math inline">\(\alpha_T = 1\)</span>, <span class="math inline">\(\beta_T = 1/(\)</span><em>equal weights tree length</em><span class="math inline">\(/\)</span><em>number of characters</em><span class="math inline">\()\)</span>, <span class="math inline">\(\alpha = c = 1\)</span>:</p>
<blockquote>
<p>prset brlenspr = unconstrained: gammadir(1, 0.35, 1, 1);</p>
</blockquote>
<p>Neomorphic and transformational characters <span class="citation">(<em>sensu</em> Sereno, <a href="#ref-Sereno2007">2007</a>)</span> were allocated to two separate partitions whose proportion of invariant characters and gamma shape parameters were allowed to vary independently:</p>
<blockquote>
<p>charset Neomorphic = 1 6 7 9 10 15 18 19 20 21 22 24 26 29 30 34 35 37 38 40 43 44 45 48 49 53 54 55 56 57 58 59 60 61 65 66 68 69 71 76 78 79 80 81 83 86 87 88 91 92 93 94 97 98 99 100 101 102 106 108 109 111 118 119 121 122 125 126 129 136 137 138 139 140 142 143 144 145 148 150 151 153 154 155 156 157 158 160 164 168 170 174 175 176 177 179 180 181 182 183 184 185 186 187 188 190 192 193 196 199 202 203 204 205 206 207 209 210 211 212 214 215 216 217 218 219 220 222 225;</p>
<p>charset Transformational = 2 3 4 5 8 11 12 13 14 16 17 23 25 27 28 31 32 33 36 39 41 42 46 47 50 51 52 62 63 64 67 70 72 73 74 75 77 82 84 85 89 90 95 96 103 104 105 107 110 112 113 114 115 116 117 120 123 124 127 128 130 131 132 133 134 135 141 146 147 149 152 159 161 162 163 165 166 167 169 171 172 173 178 189 191 194 195 197 198 200 201 208 213 221 223 224;</p>
<p>partition chartype = 2: Neomorphic, Transformational;</p>
<p>set partition = chartype;</p>
<p>unlink shape=(all) pinvar=(all);</p>
</blockquote>
<p>Neomorphic characters were not assumed to have a symmetrical transition rate – that is, the probability of the absent → present transition was allowed to differ from that of the present → absent transition, being drawn from a uniform prior:</p>
<blockquote>
<p>prset applyto=(1) symdirihyperpr=fixed(1.0);</p>
</blockquote>
<p>The rate of variation in neomorphic characters was also allowed to vary from that of transformational characters:</p>
<blockquote>
<p>prset applyto=(1) ratepr=variable;</p>
</blockquote>
<p><em>Loxosomella</em> was selected as an outgroup:</p>
<blockquote>
<p>outgroup Loxosomella;</p>
</blockquote>
<p>Four MrBayes runs were executed, each sampling eight chains for 5 000 000 generations, with samples taken every 500 generations. The first 10% of samples were discarded as burn-in.</p>
<blockquote>
<p>mcmcp ngen=5000000 samplefreq=500 nruns=4 nchains=8 burninfrac=0.1;</p>
</blockquote>
<p>A posterior tree topology was derived from the combined posterior sample of all runs. Convergence was indicated by PSRF = 1.00 and an estimated sample size of &gt; 200 for each parameter. Nodes are labelled with posterior probabilities; recall that caution must be applied when interpreting these values <span class="citation">(Z. Yang &amp; Zhu, <a href="#ref-Yang2018">2018</a>)</span>.</p>
<p>The Nexus file used to generate these results in MrBayes can be <a href="https://raw.githubusercontent.com/ms609/hyoliths/master/MrBayes/hyo.nex">downloaded</a>, and run in <a href="http://mrbayes.sourceforge.net/download.php">MrBayes</a> by typing <code>exe path/to/download</code>.</p>
<div id="parameter-estimates" class="section level2">
<h2><span class="header-section-number">3.1</span> Parameter estimates</h2>
<table>
<thead>
<tr class="header">
<th align="left">Parameter</th>
<th align="right">Mean</th>
<th align="right">Variance</th>
<th align="right">minESS</th>
<th align="right">avgESS</th>
<th align="right">PSRF</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">TL{all}</td>
<td align="right">9.980</td>
<td align="right">0.50100</td>
<td align="right">5440</td>
<td align="right">5970</td>
<td align="right">0.99999</td>
</tr>
<tr class="even">
<td align="left">m{1}</td>
<td align="right">0.462</td>
<td align="right">0.00265</td>
<td align="right">3100</td>
<td align="right">3720</td>
<td align="right">0.99999</td>
</tr>
</tbody>
</table>
</div>
<div id="results-1" class="section level2">
<h2><span class="header-section-number">3.2</span> Results</h2>
<div class="figure"><span id="fig:mrbayes-full-consensus"></span>
<img src="Brachiopod_phylogeny_files/figure-html/mrbayes-full-consensus-1.png" alt="Results of Bayesian analysis, posterior probability &gt; 50%, all taxa" width="576" />
<p class="caption">
Figure 3.1: Results of Bayesian analysis, posterior probability &gt; 50%, all taxa
</p>
</div>
<div class="figure"><span id="fig:mrbayes-pruned-consensus"></span>
<img src="Brachiopod_phylogeny_files/figure-html/mrbayes-pruned-consensus-1.png" alt="Results of Bayesian analysis, posterior probability &gt; 50%, wildcard taxa pruned" width="681.6" />
<p class="caption">
Figure 3.2: Results of Bayesian analysis, posterior probability &gt; 50%, wildcard taxa pruned
</p>
</div>

</div>
</div>
<h3>References</h3>
<div id="refs" class="references">
<div id="ref-Ronquist2012">
<p>Ronquist, F., Teslenko, M., van der Mark, P., Ayres, D. L., Darling, A., Hohna, S., … Huelsenbeck, J. P. (2012). MrBayes 3.2: Efficient Bayesian phylogenetic inference and model choice across a large model space. <em>Systematic Biology</em>, <em>61</em>(3), 539–42. doi:<a href="https://doi.org/10.1093/sysbio/sys029">10.1093/sysbio/sys029</a></p>
</div>
<div id="ref-Lewis2001">
<p>Lewis, P. O. (2001). A likelihood approach to estimating phylogeny from discrete morphological character data. <em>Systematic Biology</em>, <em>50</em>(6), 913–925. doi:<a href="https://doi.org/10.1080/106351501753462876">10.1080/106351501753462876</a></p>
</div>
<div id="ref-Rannala2012">
<p>Rannala, B., Zhu, T.-Q., &amp; Yang, Z.-H. (2012). Tail paradox, partial identifiability, and influential priors in Bayesian branch length inference. <em>Molecular Biology and Evolution</em>, <em>29</em>(1), 325–335. doi:<a href="https://doi.org/10.1093/molbev/msr210">10.1093/molbev/msr210</a></p>
</div>
<div id="ref-Zhang2012">
<p>Zhang, C., Rannala, B., &amp; Yang, Z.-H. (2012). Robustness of compound Dirichlet priors for Bayesian inference of branch lengths. <em>Systematic Biology</em>, <em>61</em>(5), 779–84. doi:<a href="https://doi.org/10.1093/sysbio/sys030">10.1093/sysbio/sys030</a></p>
</div>
<div id="ref-Sereno2007">
<p>Sereno, P. C. (2007). Logical basis for morphological characters in phylogenetics. <em>Cladistics</em>, <em>23</em>(6), 565–587. doi:<a href="https://doi.org/10.1111/j.1096-0031.2007.00161.x">10.1111/j.1096-0031.2007.00161.x</a></p>
</div>
<div id="ref-Yang2018">
<p>Yang, Z., &amp; Zhu, T. (2018). Bayesian selection of misspecified models is overconfident and may cause spurious posterior probabilities for phylogenetic trees. <em>Proceedings of the National Academy of Sciences</em>, <em>115</em>(8), 1854–1859. doi:<a href="https://doi.org/10.1073/pnas.1712673115">10.1073/pnas.1712673115</a></p>
</div>
</div>
<script>
/*
Sorts the references alphabetically.
Modified from code by Yvonne Aburrow.
*/

$(function(){
    var elems = $('#refs').children('div').remove();
    elems.sort(function (a, b) {
        return $(b).children('p').html() > $(a).children('p').html() ? -1 : 1;
    });
    $('#refs').append(elems);
})
</script>
            </section>

          </div>
        </div>
      </div>
<a href="fitch.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="treesearch.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/ms609/hyoliths/edit/master/13_MrBayes.Rmd",
"text": "Edit"
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "";
    if (src === "" || src === "true") src = "https://cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
