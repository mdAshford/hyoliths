<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Supplementary Information for: Hyoliths with pedicles constrain the origin of the brachiopod body plan</title>
  <meta name="description" content="Results of phylogenetic analysis">
  <meta name="generator" content="bookdown 0.7.12 and GitBook 2.6.7">

  <meta property="og:title" content="Supplementary Information for: Hyoliths with pedicles constrain the origin of the brachiopod body plan" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Results of phylogenetic analysis" />
  <meta name="github-repo" content="ms609/hyoliths" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Supplementary Information for: Hyoliths with pedicles constrain the origin of the brachiopod body plan" />
  
  <meta name="twitter:description" content="Results of phylogenetic analysis" />
  

<meta name="author" content="Haijing Sun, Martin R. Smith, Han Zeng, Fangchen Zhao, Guoxiang Li and Maoyan Zhu">


<meta name="date" content="2018-06-15">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="treesearch.html">
<link rel="next" href="taxonomic-implications.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />







<link rel="apple-touch-icon" sizes="180x180" href="icons/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="icons/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="icons/favicon-16x16.png">
<link rel="manifest" href="icons/site.webmanifest">
<link rel="mask-icon" href="icons/safari-pinned-tab.svg" color="#5bbad5">
<link rel="shortcut icon" href="icons/favicon.ico">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="msapplication-config" content="icons/browserconfig.xml">
<meta name="theme-color" content="#ffffff">


<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Supplementary Text</a></li>
<li class="chapter" data-level="1" data-path="dataset.html"><a href="dataset.html"><i class="fa fa-check"></i><b>1</b> Phylogenetic dataset</a></li>
<li class="chapter" data-level="2" data-path="fitch.html"><a href="fitch.html"><i class="fa fa-check"></i><b>2</b> Fitch parsimony</a><ul>
<li class="chapter" data-level="2.1" data-path="fitch.html"><a href="fitch.html#results"><i class="fa fa-check"></i><b>2.1</b> Results</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="bayesian.html"><a href="bayesian.html"><i class="fa fa-check"></i><b>3</b> Bayesian analysis</a><ul>
<li class="chapter" data-level="3.1" data-path="bayesian.html"><a href="bayesian.html#parameter-estimates"><i class="fa fa-check"></i><b>3.1</b> Parameter estimates</a></li>
<li class="chapter" data-level="3.2" data-path="bayesian.html"><a href="bayesian.html#results-1"><i class="fa fa-check"></i><b>3.2</b> Results</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="treesearch.html"><a href="treesearch.html"><i class="fa fa-check"></i><b>4</b> Parsimony analysis</a><ul>
<li class="chapter" data-level="4.1" data-path="treesearch.html"><a href="treesearch.html#search-parameters"><i class="fa fa-check"></i><b>4.1</b> Search parameters</a></li>
<li class="chapter" data-level="4.2" data-path="treesearch.html"><a href="treesearch.html#analysis"><i class="fa fa-check"></i><b>4.2</b> Analysis</a><ul>
<li class="chapter" data-level="4.2.1" data-path="treesearch.html"><a href="treesearch.html#initialize-and-load-data"><i class="fa fa-check"></i><b>4.2.1</b> Initialize and load data</a></li>
<li class="chapter" data-level="4.2.2" data-path="treesearch.html"><a href="treesearch.html#generate-starting-tree"><i class="fa fa-check"></i><b>4.2.2</b> Generate starting tree</a></li>
<li class="chapter" data-level="4.2.3" data-path="treesearch.html"><a href="treesearch.html#implied-weights-analysis"><i class="fa fa-check"></i><b>4.2.3</b> Implied weights analysis</a></li>
<li class="chapter" data-level="4.2.4" data-path="treesearch.html"><a href="treesearch.html#equal-weights-analysis"><i class="fa fa-check"></i><b>4.2.4</b> Equal weights analysis</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="treesearch.html"><a href="treesearch.html#results-2"><i class="fa fa-check"></i><b>4.3</b> Results</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="reconstructions.html"><a href="reconstructions.html"><i class="fa fa-check"></i><b>5</b> Character reconstructions</a></li>
<li class="chapter" data-level="6" data-path="taxonomic-implications.html"><a href="taxonomic-implications.html"><i class="fa fa-check"></i><b>6</b> Taxonomic implications</a></li>
<li class="chapter" data-level="" data-path="figures.html"><a href="figures.html"><i class="fa fa-check"></i>Supplementary Figures</a></li>
<li class="chapter" data-level="" data-path="table.html"><a href="table.html"><i class="fa fa-check"></i>Supplementary Table</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Supplementary Information for: Hyoliths with pedicles constrain the origin of the brachiopod body plan</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="reconstructions" class="section level1">
<h1><span class="header-section-number">5</span> Character reconstructions</h1>
<p>This page provides definitions for each of the characters in our matrix, and justifies codings in particular taxa where relevant. Further citations for codings that are not discussed in the text can be viewed by browsing the <a href="dataset.html#dataset">morphological dataset</a> on MorphoBank (<a href="https://morphobank.org/permalink/?P2800">project 2800</a>). <mark>This link will become live on publication of the paper. Referees should follow the pre-publication link to the dataset that has been provided in the main manuscript.</mark></p>
<p>Alongside its definition, each character has been mapped onto a tree. Any of the optimal trees can be selected by modifying the tree number listed above each diagram. Each tip is labelled according to its coding in the matrix. These states have been used to reconstruct the condition of each internal node, using the parsimony method of <span class="citation">Brazeau et al. (<a href="#ref-Brazeau2018">2018</a>)</span> as implemented in the <em>Inapp</em> <em>R</em> package.</p>
<p>We emphasize that different trees will give different reconstructions. The character mappings are not intended to definitively establish how each character evolved, but to help the reader quickly establish how each character has been coded, and to visualize at a glance how each character fits onto a given tree.</p>

<div class="figure"><span id="fig:all-changes"></span>
<img src="Brachiopod_phylogeny_files/figure-html/all-changes-1.png" alt="All character changes mapped onto a single consensus tree. Logically coherent changes are marked in blue; logically impossible changes (which are nevertheless reconstructed by the Fitch algorithm) are marked in red. Orange denotes nodes at which homoplasy due to additional regions is mapped.[…]" width="768" />
<p class="caption">
Figure 5.1: All character changes mapped onto a single consensus tree. Logically coherent changes are marked in <span class="color: #2c7bb6;">blue</span>; logically impossible changes (which are nevertheless reconstructed by the Fitch algorithm) are marked in <span class="color: #d7191c;">red</span>. <span class="color: #fdae61;">Orange</span> denotes nodes at which homoplasy due to additional regions is mapped.[…]
</p>
</div>
<script>
var latestKnownScrollY = 0,
  latestKnownY = 0,
    ticking = false;

function onScreen(e, viewTop, viewHeight) {
  var viewBottom = viewTop + viewHeight;
  var elemTop = $(e).offset().top;
  return ((elemTop <= viewBottom + 1000) && (elemTop >= viewTop - 1000));
}

function highlightTaxon (e) {
  var target = e.target; // Which node triggered the click
  $target = $(target);
  if (target.nodeName === 'text') {
    taxonText = $(target).text();
    $withSameText = $('#reconstructions svg text:contains("' + taxonText + '")')
    if (localStorage.getItem(taxonText)) {
      localStorage.removeItem(taxonText)
      $withSameText.removeClass("highlightTaxon");
    } else {
      localStorage.setItem(taxonText, 1)
      $withSameText.addClass("highlightTaxon");
    }
  }
  return false;
}

function applyHighlighting () {
  if(localStorage.getItem($(this).text())) {
    $(this).addClass("highlightTaxon");
  }
}

function onScroll() {
  //Optimised via https://www.html5rocks.com/en/tutorials/speed/animations/
  latestKnownScrollY = window.scrollY;
  latestKnownY = $(window).height();
  requestTick();
}

function requestTick() {
  if (!ticking) {
    requestAnimationFrame(updateVisible);
  }
  ticking = true;
}

function updateVisible() {
  ticking = false; // Reset, ready to capture next scroll/resize
  chosenTree = localStorage.getItem("chosenTree");
  var currentScrollY = latestKnownScrollY;
  var currentHeight = latestKnownY;
  $("svg.tree").each(function(index, item) {
    if (onScreen($(this), currentScrollY, currentHeight)) {
      if ($(this).data('tree') != chosenTree) {        
        var oldTree = $(item);
        $.ajax({
           //url: "Brachiopod_phylogeny_files/figure-html/tree" + chosenTree + "-char" + $(oldTree).data("char") + ".svg",
           url: "Brachiopod_phylogeny_files/figure-html/tree" + chosenTree + "-char" +
                $(oldTree).data("char") + ".svg",
          context: item,
          datatype: 'xml'
        }).done(function (newTree) {
          $newSvg = $('svg', newTree);
          $newSvg.data('tree', chosenTree);
          $newSvg.click(highlightTaxon);
          $('text', $newSvg).each(applyHighlighting);
          $(this).replaceWith($newSvg);
        })
      }
    }
  });
  return false;
}

function switchTree(input) {
  newValue = input.value * 1;
  if (!isNaN(newValue)) {
    newValue = Math.floor(newValue);
    newValue = Math.max(newValue, 1);
    newValue = Math.min(newValue, input.max);
    $("input.switcherNumber").val(newValue);
    localStorage.setItem("chosenTree", newValue);
    updateVisible()
  }
  return false;
}


$(document).ready(function() {
  window.$my = {
    trees : $("svg.tree")
  };

  // Produce switcher box by each SVG plot
  var originalSwitcher = $("div.switcher");
  $my.trees.each(function() {
      var thisTree = $(this);
      var switcherClone = originalSwitcher.clone().insertBefore(thisTree);
      $('input.switcherNumber', switcherClone).data("char", thisTree.data("char"));
    }
  );
  
  localStorage.setItem("chosenTree", originalSwitcher.val());
  $my.trees.click(highlightTaxon)
  $my.trees.data('tree', originalSwitcher.val());
  $('text', $my.trees).each(applyHighlighting)
  
  $(".book-body").scroll(onScroll);
  $(".book-body").resize(onScroll);
  
  $(".body-inner").resize(onScroll);
  $(".body-inner").scroll(onScroll);
  // page-wrapper and page-inner are the other things that might trigger events?
  
  originalSwitcher.remove();
  return false;
});
</script>

</div>
<h3>References</h3>
<div id="refs" class="references">
<div id="ref-Brazeau2018">
<p>Brazeau, M. D., Guillerme, T., &amp; Smith, M. R. (2018). An algorithm for morphological phylogenetic analysis with inapplicable data. <em>Systematic Biology</em>. doi:<a href="https://doi.org/10.1101/209775">10.1101/209775</a></p>
</div>
</div>
<script>
/*
Sorts the references alphabetically.
Modified from code by Yvonne Aburrow.
*/

$(function(){
    var elems = $('#refs').children('div').remove();
    elems.sort(function (a, b) {
        return $(b).children('p').html() > $(a).children('p').html() ? -1 : 1;
    });
    $('#refs').append(elems);
})
</script>
            </section>

          </div>
        </div>
      </div>
<a href="treesearch.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="taxonomic-implications.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/ms609/hyoliths/edit/master/15_Characters.Rmd",
"text": "Edit"
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "";
    if (src === "" || src === "true") src = "https://cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
