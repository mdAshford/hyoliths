---
title: "Standard (Fitch) parsimony results"
author: "Martin R. Smith"
date: "`r Sys.Date()`"
---

```{R TNT_function_definitions, echo=FALSE}
plotPanel <- function (i) {
  ColPlot(tnConsensi[[i]])
  text(1, 0.5, paste('k =', kValues[i]), pos=4, cex=0.6)
}
```

# Fitch parsimony {#tnt}

Parsimony search was conducted in TNT v1.5 [@Goloboff2016] using ratchet and tree drifting heuristics [@Goloboff1999;@Nixon1999], repeating the search until the optimal score had been hit by 1500 independent searches:

> xmult:rat10 drift10 hits 1500 level 4 chklevel 5;

Searches were conducted under equal weights and results saved to file:

> piwe-; xmult; 
>
> tsav *TNT/ew.tre;sav;tsav/;

Further searches were conducted under extended implied weighting [@Goloboff1997;@Goloboff2014], under the concavity constants 2, 3, 4.5, 7, 10.5, 16 and 24:

> xpiwe=; /* Enable extended implied weighting */
>
> piwe=2; xmult; /* Conduct analysis at k = 2 */
>
> tsav *TNT/xpiwe2.tre; sav; tsav/; /* Save results to file */
> 
> keep 0; hold 10000; /* Clear trees from memory */
>
> piwe=3; xmult; /* Conduct analysis at k = 3 */
>
> tsav *TNT/xpiwe3.tre; sav ;tsav/; /* Save results to file */

We acknowledge the Willi Hennig Society for their sponsorship of the TNT software.

```{R, echo=FALSE}
tntFiles <- list.files('TNT/', pattern='xpiwe.*\\.tre', full=TRUE)
filename <- tntFiles[1]
tnTrees <- lapply(tntFiles, ReadTntTree)
tnConsensi <- lapply(tnTrees, consensus)
```

## Implied weights

The consensus of all implied weights runs is not very well resolved:

```{R, echo=FALSE, fig.wid=7.1, fig.height=4}
par(mfrow=c(1, 2))
ColPlot(consensus(tnConsensi)) 
text(1, 0.5, 'Consensus of all k values', pos=4, cex=0.6)

plotPanel(1)
```
```{R, echo=FALSE}
par(mfrow=c(1, 2))
plotPanel(2)
plotPanel(3)
```

```{R, echo=FALSE}
par(mfrow=c(1, 2))
plotPanel(4)
plotPanel(5)
```

```{R, echo=FALSE}
par(mfrow=c(1, 2))
plotPanel(6)
plotPanel(7)
```

This lack of resolution is largely a product of a few wildcard taxa, which obscure relationships that are nevertheless present in all most parsimonious trees:

### Paterinids included

```{R, echo=FALSE, fig.cap="TNT implied weights consensus"}
omit <- c('Clupeafumosus_socialis', 'Micrina', 'Mickwitzia_muralensis', 'Paterimitra', 'Heliomedusa_orienta', 'Tomteluva_perturbata', 'Yuganotheca_elegans', 'Salanygolina', 'Gasconsia', 'Mummpikia_nuda')
ColPlot(ConsensusWithout(tnConsensi, omit))
ColMissing(omit)
```

### Paterinids excluded

```{R, echo=FALSE, fig.cap="TNT implied weights consensus"}
omit <- c('Clupeafumosus_socialis', 'Micrina', 'Mickwitzia_muralensis', 'Paterimitra', 'Heliomedusa_orienta', 'Tomteluva_perturbata', 'Yuganotheca_elegans', 'Salanygolina', 'Gasconsia', 'Mummpikia_nuda', 'Kutorgina_chengjiangensis', 'Nisusia_sulcata')
ColPlot(ConsensusWithout(tnConsensi, omit))
ColMissing(omit)
```


## Equal weights

```{R, echo=FALSE, fig.cap="TNT Equal weights consensus"}
tntEw <- list.files('TNT/', pattern='ew\\.tre', full=TRUE)
ColPlot(ConsensusWithout(ReadTntTree(tntEw), lon))
ColMissing(lon)
```
